<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anonymous Messages</title>

<style>
body{
margin:0;
font-family:sans-serif;
background:linear-gradient(135deg,#1a0754,#f34313);
min-height:100vh;
padding:20px;
}
.container{max-width:600px;margin:auto}
.card{background:#fff;border-radius:15px;padding:15px;margin-bottom:15px}
textarea,input{width:100%;padding:10px;border-radius:10px;border:1px solid #ccc}
button{padding:10px;border-radius:10px;border:none;background:#667eea;color:#fff;font-weight:bold}
.feed{margin-top:20px}
.msg{background:#fff;border-radius:12px;padding:12px;margin-bottom:10px}
.comment{background:#eee;padding:6px;border-radius:6px;margin-top:5px}
small{color:#777}
</style>
</head>

<body>
<div class="container">

<h2 style="color:white;text-align:center">üí¨ ‡∏ù‡∏≤‡∏Å‡∏ö‡∏≠‡∏Åcvc</h2>

<div class="card">
‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå:
<input id="link" readonly>
<button onclick="copy()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
</div>

<div class="card">
<textarea id="msg" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°"></textarea>
<button onclick="send()">‡∏™‡πà‡∏á</button>
</div>

<div id="feed" class="feed"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
apiKey: "AIzaSyBmSR9eevEkOIsR2afmw8OHwIxdITGimI",
authDomain: "anonymous-messages-233e0.firebaseapp.com",
databaseURL: "https://anonymous-messages-233e0-default-rtdb.firebaseio.com",
projectId: "anonymous-messages-233e0",
storageBucket: "anonymous-messages-233e0.appspot.com",
messagingSenderId: "199481033392",
appId: "1:199481033392:web:422a4f59b74b0f2a097175"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const msgRef = ref(db,"messages");

document.getElementById("link").value = location.href;

window.copy=()=>{
navigator.clipboard.writeText(location.href);
alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
}

window.send=()=>{
const t=document.getElementById("msg").value.trim();
if(!t)return;

push(msgRef,{
text:t,
time:Date.now(),
comments:{}
});

document.getElementById("msg").value="";
}

onValue(msgRef,snap=>{
let h="";
let count=0;

snap.forEach(x=>{
count++;
const d=x.val();
const k=x.key;

if(Date.now()-d.time>86400000){
remove(ref(db,"messages/"+k));
return;
}

h+=`<div class="msg">
<b>‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</b><br>
${escape(d.text)}<br>
<small>${new Date(d.time).toLocaleString()}</small>

<div>
<input id="c${k}" placeholder="‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå">
<button onclick="comment('${k}')">‡∏™‡πà‡∏á</button>
</div>
`;

if(d.comments){
Object.values(d.comments).forEach(c=>{
h+=`<div class="comment">${escape(c.text)}</div>`;
});
}

h+="</div>";
});

if(count==0)h="<p style='color:white;text-align:center'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</p>";

document.getElementById("feed").innerHTML=h;
});

window.comment=(k)=>{
const i=document.getElementById("c"+k);
if(!i.value.trim())return;

push(ref(db,"messages/"+k+"/comments"),{
text:i.value,
time:Date.now()
});
i.value="";
}

function escape(t){
const d=document.createElement("div");
d.innerText=t;
return d.innerHTML;
}

</script>
</body>
</html>
